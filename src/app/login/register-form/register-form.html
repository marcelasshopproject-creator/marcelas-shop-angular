<form class="max-w-sm mx-auto text-center relative" [formGroup]="form" (ngSubmit)="signUp()">
  <!---------- Fullname ----------->
  <div class="mb-5 relative">
    <label for="fullname" class="block text-left mb-1 text-sm font-medium text-gray-900"
      >Tu Nombre</label
    >
    <input
      type="text"
      id="fullname"
      formControlName="fullname"
      class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
      required
    />
    @if (form.controls.fullname.touched && form.controls.fullname.hasError('required')) {
      <p class="mt-2 bottom-[-1rem] text-xs text-red-600 absolute">Tu nombre es requerido</p>
    } @else if (form.controls.fullname.touched && form.controls.fullname.hasError('pattern')) {
      <p class="mt-2 bottom-[-1rem] text-xs text-red-600 absolute">Solo se permiten letras</p>
    }
  </div>

  <!---------- Address ----------->
  <div class="mb-5 relative">
    <label for="address" class="block text-left mb-1 text-sm font-medium text-gray-900"
      >Tu Dirección</label
    >
    <input
      type="text"
      id="address"
      formControlName="address"
      class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
      required
    />
    @if (form.controls.address.touched && form.controls.address.hasError('required')) {
      <p class="mt-2 bottom-[-1rem] text-xs text-red-600 absolute">Tu dirección es requerida</p>
    }
  </div>

  <!---------- Phone ----------->
  <div class="mb-5 relative">
    <label for="phone" class="block text-left mb-1 text-sm font-medium text-gray-900"
      >Tu Teléfono</label
    >
    <input
      type="text"
      id="phone"
      formControlName="phone"
      class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
      required
    />
    @if (form.controls.phone.touched && form.controls.phone.hasError('required')) {
      <p class="mt-2 bottom-[-1rem] text-xs text-red-600 absolute">Tu teléfono es requerido</p>
    } @else if (form.controls.phone.touched && form.controls.phone.hasError('pattern')) {
      <p class="mt-2 bottom-[-1rem] text-xs text-red-600 absolute">Solo números válidos</p>
    }
  </div>

  <!---------- Email ----------->
  <div class="mb-5 relative">
    <label for="email" class="block text-left mb-1 text-sm font-medium text-gray-900"
      >Tu Email</label
    >
    <input
      type="email"
      id="email"
      formControlName="email"
      class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
      placeholder="name@email.com"
      required
    />
    @if (form.controls.email.touched && form.controls.email.hasError('required')) {
      <p class="mt-2 bottom-[-1rem] text-xs text-red-600 absolute">El email es requerido</p>
    } @else if (form.controls.email.touched && form.controls.email.hasError('pattern')) {
      <p class="mt-2 bottom-[-1rem] text-xs text-red-600 absolute">Formato inválido</p>
    }
  </div>

  <!---------- Password ----------->
  <div class="mb-5 relative">
    <label for="password" class="block text-left mb-1 text-sm font-medium text-gray-900"
      >Contraseña</label
    >
    <input
      type="password"
      id="password"
      formControlName="password"
      class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
      required
    />
    @if (form.controls.password.touched && form.controls.password.hasError('required')) {
      <p class="mt-2 bottom-[-1rem] text-xs text-red-600 absolute">La contraseña es requerida</p>
    } @else if (form.controls.password.touched && form.controls.password.hasError('pattern')) {
      <p class="mt-2 bottom-[-1rem] text-xs text-red-600 absolute">
        Mínimo 8 caracteres, una letra, un número y un carácter especial
      </p>
    }
  </div>

  <!---------- Repeat Password ----------->
  <div class="mb-9 relative">
    <label for="password-repeat" class="block text-left mb-2 text-sm font-medium text-gray-900"
      >Repite la contraseña</label
    >
    <input
      type="password"
      id="password-repeat"
      formControlName="passwordRepeat"
      class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
      required
    />
    @if (form.controls.passwordRepeat.touched && form.controls.passwordRepeat.hasError('required')) {
      <p class="mt-2 bottom-[-1rem] text-xs text-red-600 absolute">La contraseña es requerida</p>
    } @if (form.hasError('passwordMismatch')) {
      <p class="mt-2 bottom-[-1rem] text-xs text-red-600 absolute">Las contraseñas no coinciden.</p>
    }
  </div>

  <!---------- Button ----------->
  <button
    type="submit"
    class="max-auto text-white bg-pink-500 hover:bg-pink-900 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center"
  >
    Registrar
  </button>

  <!---------- ALERTA CAMPOS VACÍOS ----------->
  @if (form.invalid && form.touched) {
    <div class="mt-3 text-sm text-red-600 font-medium">
      Debes completar todos los campos
    </div>
  }

  <!---------- Status ----------->
  @if (requestStatus() === "success") {
    <div
      class="w-full max-w-[400px] mx-auto bg-green-500 py-3 text-center text-white rounded-lg absolute left-[50%] translate-x-[-50%] bottom-[-6rem]"
    >
      Usuario creado satisfactoriamente
    </div>
  } @else if (requestStatus() === "error") {
    <div
      class="w-full max-w-[400px] mx-auto bg-red-600 text-center text-white py-3 rounded-lg absolute left-[50%] translate-x-[-50%] bottom-[-6rem]"
    >
      {{ errorMessage() }}
    </div>
  }

  <!---------- LOADING ----------->
  @if (requestStatus() === 'loading') {
    <app-loading />
  }
</form>


@if (requestStatus() === 'loading') {
  <app-loading />
}
